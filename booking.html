<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Запись - Radiant Reflections</title>
    <link rel="stylesheet" href="style.css">
    <style>
        /* Стили для скрытых секций */
        .hidden-section {
            display: none;
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.5s ease, transform 0.5s ease;
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 1px solid #eee;
        }
        
        .hidden-section.show {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }
        
        .service-option {
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }
        
        .service-option:hover {
            border-color: #f0f0f0;
        }
        
        .service-option input[type="radio"]:checked + .option-content {
            background-color: #f9f5f0;
        }
        
        /* Стили для успешной отправки (локальное сообщение) */
        .success-message {
            display: none;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border: 2px solid #4CAF50;
            border-radius: 15px;
            padding: 3rem 2rem;
            text-align: center;
            margin: 2rem auto;
            max-width: 600px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }
        
        .success-message.show {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .checkmark {
            font-size: 4rem;
            color: #4CAF50;
            margin-bottom: 1rem;
            display: block;
        }
        
        /* Кнопка подтверждения */
        .btn-confirm {
            background: linear-gradient(135deg, #8b7355 0%, #a89276 100%);
            color: white;
            padding: 15px 40px;
            border: none;
            border-radius: 30px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 2rem;
            display: inline-block;
            width: 100%;
            max-width: 300px;
        }
        
        .btn-confirm:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(139, 115, 85, 0.3);
        }
    </style>
</head>
<body>
    <header class="header">
        <nav class="nav">
            <div class="nav-brand">
                <a href="index.html" style="text-decoration: none; color: inherit;">
                    <div class="logo-container">
                        <div class="logo">RR</div>
                        <div class="logo-text">
                            <div class="logo-main">Radiant Reflections</div>
                            <div class="logo-sub">Профессиональный визажист</div>
                        </div>
                    </div>
                </a>
            </div>
            
            <button class="hamburger">
                <span></span>
                <span></span>
                <span></span>
            </button>
            
            <ul class="nav-menu">
                <li><a href="index.html">Главная</a></li>
                <li><a href="services.html">Услуги</a></li>
                <li><a href="portfolio.html">Портфолио</a></li>
                <li><a href="reviews.html">Отзывы</a></li>
                <li><a href="contacts.html">Контакты</a></li>
                <li><a href="booking.html" class="active">Запись</a></li>
            </ul>
        </nav>
    </header>

    <section class="page-header">
        <div class="container">
            <h1>Онлайн запись</h1>
            <p>Выберите удобное время для визита</p>
        </div>
    </section>

    <section class="booking">
        <div class="container">
            <!-- Сообщение об успешной отправке (скрыто изначально) -->
            <div id="successMessage" class="success-message">
                <span class="checkmark">✓</span>
                <h2 style="color: #2E7D32; margin-bottom: 1rem;">Заявка принята!</h2>
                <p style="margin-bottom: 1.5rem; font-size: 1.1rem;">
                    Спасибо за вашу заявку. Сейчас вы будете перенаправлены на страницу подтверждения.
                </p>
                <div style="background: white; padding: 1.5rem; border-radius: 10px; margin: 1.5rem 0; text-align: left;">
                    <h4 style="color: #8b7355; margin-bottom: 1rem;">Детали вашей записи:</h4>
                    <div id="successDetails"></div>
                </div>
                <p style="color: #666; font-size: 0.9rem;">
                    Перенаправление через <span id="countdown">5</span> секунд...
                </p>
            </div>

            <!-- Форма записи -->
            <form id="bookingForm" class="booking-form" action="thank-you.html" method="get">
                <input type="hidden" name="form_type" value="booking">
                
                <h2>Выберите услугу</h2>
                <div class="service-options">
                    <label class="service-option">
                        <input type="radio" name="service" value="Свадебный макияж" required>
                        <div class="option-content">
                            <h3>Свадебный макияж</h3>
                            <p>от 8 000 ₽</p>
                            <span>Идеальный образ для самого важного дня</span>
                        </div>
                    </label>

                    <label class="service-option">
                        <input type="radio" name="service" value="Вечерний макияж">
                        <div class="option-content">
                            <h3>Вечерний макияж</h3>
                            <p>от 5 500 ₽</p>
                            <span>Для мероприятий и особых случаев</span>
                        </div>
                    </label>

                    <label class="service-option">
                        <input type="radio" name="service" value="Обучение макияжу">
                        <div class="option-content">
                            <h3>Обучение макияжу</h3>
                            <p>от 20 000 ₽</p>
                            <span>Индивидуальные уроки макияжа</span>
                        </div>
                    </label>

                    <label class="service-option">
                        <input type="radio" name="service" value="Express-макияж">
                        <div class="option-content">
                            <h3>Express-макияж</h3>
                            <p>от 4 000 ₽</p>
                            <span>Быстрый макияж для повседневности</span>
                        </div>
                    </label>

                    <label class="service-option">
                        <input type="radio" name="service" value="Свадебный пакет премиум">
                        <div class="option-content">
                            <h3>Свадебный пакет премиум</h3>
                            <p>16 500 ₽</p>
                            <span>Макияж + прическа + консультация + пробная сессия</span>
                        </div>
                    </label>

                    <label class="service-option">
                        <input type="radio" name="service" value="Курс 'Мастер макияжа'">
                        <div class="option-content">
                            <h3>Курс "Мастер макияжа"</h3>
                            <p>19 900 ₽</p>
                            <span>Полный курс профессионального макияжа (5 занятий)</span>
                        </div>
                    </label>

                    <label class="service-option">
                        <input type="radio" name="service" value="Осеннее преображение">
                        <div class="option-content">
                            <h3>Осеннее преображение</h3>
                            <p>5 900 ₽</p>
                            <span>Сезонный макияж в теплых осенних тонах + уход</span>
                        </div>
                    </label>

                    <label class="service-option">
                        <input type="radio" name="service" value="Приведи подругу">
                        <div class="option-content">
                            <h3>Приведи подругу</h3>
                            <p>от 4 000 ₽</p>
                            <span>Скидка 25% для каждой при записи вдвоем</span>
                        </div>
                    </label>
                </div>

                <!-- Дата и время -->
                <div id="dateTimeSection" class="hidden-section">
                    <h2>Выберите дату и время</h2>
                    <div class="form-group">
                        <label>Дата:</label>
                        <input type="date" id="dateInput" name="date" required>
                    </div>
                    
                    <div class="form-group">
                        <label>Время:</label>
                        <select id="timeSelect" name="time" required>
                            <option value="">Выберите время</option>
                            <option value="10:00">10:00</option>
                            <option value="11:00">11:00</option>
                            <option value="12:00">12:00</option>
                            <option value="13:00">13:00</option>
                            <option value="14:00">14:00</option>
                            <option value="15:00">15:00</option>
                            <option value="16:00">16:00</option>
                            <option value="17:00">17:00</option>
                            <option value="18:00">18:00</option>
                        </select>
                    </div>
                </div>

                <!-- Контактные данные -->
                <div id="contactSection" class="hidden-section">
                    <h2>Ваши контактные данные</h2>
                    <div class="form-group">
                        <input type="text" id="nameInput" name="name" placeholder="Ваше имя" required>
                    </div>
                    
                    <div class="form-group">
                        <input type="tel" id="phoneInput" name="phone" placeholder="Телефон" required>
                    </div>
                    
                    <div class="form-group">
                        <input type="email" id="emailInput" name="email" placeholder="Email" required>
                    </div>
                    
                    <div class="form-group">
                        <textarea id="messageInput" name="message" placeholder="Дополнительные пожелания..." rows="3"></textarea>
                    </div>

                    <button type="submit" class="btn-confirm">Подтвердить запись</button>
                </div>
            </form>

            <!-- Альтернативные способы записи -->
            <div style="text-align: center; margin-top: 3rem; padding: 2rem; background: var(--light); border-radius: 10px;">
                <h3>Альтернативные способы записи</h3>
                <p>Если форма не работает, свяжитесь со мной напрямую:</p>
                <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap; margin-top: 1rem;">
                    <a href="tel:+79803429804" class="btn-primary">+7 (980) 342-98-04</a>
                    <a href="https://wa.me/79991234567" class="btn-secondary" target="_blank">WhatsApp</a>
                    <a href="https://t.me/ваш_телеграм" class="btn-secondary" target="_blank">Telegram</a>
                    <a href="mailto:dasha-chernyshka@yandex.ru?subject=Запись на макияж" class="btn-secondary">Почта</a>
                </div>
            </div>
        </div>
    </section> 

    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-brand">
                    <a href="index.html" style="text-decoration: none; color: inherit;">
                        <div class="logo-container" style="gap: 0.8rem;">
                            <div class="logo" style="width: 40px; height: 40px; font-size: 1rem;">RR</div>
                            <div class="logo-text">
                                <div class="logo-main" style="color: white; font-size: 1.3rem;">Radiant Reflections</div>
                                <div class="logo-sub" style="color: rgba(255,255,255,0.7);">Ваш профессиональный визажист</div>
                            </div>
                        </div>
                    </a>
                </div>
                <div class="footer-links">
                    <a href="contacts.html">Контакты</a>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Radiant Reflections. Все права защищены.</p>
            </div>
        </div>
    </footer>

    <script src="script.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Элементы формы
            const bookingForm = document.getElementById('bookingForm');
            const successMessage = document.getElementById('successMessage');
            const successDetails = document.getElementById('successDetails');
            const serviceOptions = document.querySelectorAll('.service-option input[type="radio"]');
            const dateTimeSection = document.getElementById('dateTimeSection');
            const contactSection = document.getElementById('contactSection');
            const dateInput = document.getElementById('dateInput');
            const timeSelect = document.getElementById('timeSelect');
            const nameInput = document.getElementById('nameInput');
            const phoneInput = document.getElementById('phoneInput');
            const emailInput = document.getElementById('emailInput');
            const messageInput = document.getElementById('messageInput');
            
            // 1. Показываем дату и время при выборе услуги
            serviceOptions.forEach(option => {
                option.addEventListener('change', function() {
                    if (this.checked && dateTimeSection) {
                        // Визуальное выделение выбранной услуги
                        document.querySelectorAll('.service-option').forEach(opt => {
                            opt.style.borderColor = '';
                        });
                        this.closest('.service-option').style.borderColor = '#8b7355';
                        
                        // Показываем секцию с датой и временем
                        setTimeout(() => {
                            dateTimeSection.classList.add('show');
                            dateTimeSection.scrollIntoView({
                                behavior: 'smooth',
                                block: 'center'
                            });
                        }, 300);
                    }
                });
            });
            
            // 2. Показываем контактные данные при выборе даты и времени
            function checkDateTime() {
                if (dateInput && timeSelect && dateInput.value && timeSelect.value) {
                    setTimeout(() => {
                        if (contactSection) {
                            contactSection.classList.add('show');
                            contactSection.scrollIntoView({
                                behavior: 'smooth',
                                block: 'center'
                            });
                        }
                    }, 300);
                } else if (contactSection) {
                    contactSection.classList.remove('show');
                }
            }
            
            if (dateInput) {
                dateInput.addEventListener('change', checkDateTime);
                
                // Настройка даты (от завтра до +3 месяца)
                const tomorrow = new Date();
                tomorrow.setDate(tomorrow.getDate() + 1);
                dateInput.min = tomorrow.toISOString().split('T')[0];
                
                const maxDate = new Date();
                maxDate.setMonth(maxDate.getMonth() + 3);
                dateInput.max = maxDate.toISOString().split('T')[0];
                
                // Дата по умолчанию (через 2 дня)
                const defaultDate = new Date();
                defaultDate.setDate(defaultDate.getDate() + 2);
                dateInput.value = defaultDate.toISOString().split('T')[0];
            }
            
            if (timeSelect) {
                timeSelect.addEventListener('change', checkDateTime);
                // Время по умолчанию
                timeSelect.value = '14:00';
            }
            
            // 3. Обработка отправки формы
            if (bookingForm) {
                bookingForm.addEventListener('submit', function(e) {
                    // Проверяем обязательные поля
                    const requiredFields = [
                        {field: document.querySelector('.service-option input[type="radio"]:checked'), name: 'услуга'},
                        {field: dateInput, name: 'дата'},
                        {field: timeSelect, name: 'время'},
                        {field: nameInput, name: 'имя'},
                        {field: phoneInput, name: 'телефон'},
                        {field: emailInput, name: 'email'}
                    ];
                    
                    let isValid = true;
                    let firstInvalidField = null;
                    
                    requiredFields.forEach(item => {
                        if (!item.field || !item.field.value.trim()) {
                            isValid = false;
                            if (item.field) {
                                item.field.style.borderColor = '#ff4444';
                                if (!firstInvalidField) firstInvalidField = item.field;
                            }
                        } else if (item.field) {
                            item.field.style.borderColor = '';
                        }
                    });
                    
                    // Валидация email
                    if (emailInput && emailInput.value.trim()) {
                        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                        if (!emailRegex.test(emailInput.value.trim())) {
                            isValid = false;
                            emailInput.style.borderColor = '#ff4444';
                            if (!firstInvalidField) firstInvalidField = emailInput;
                        }
                    }
                    
                    // Валидация телефона
                    if (phoneInput && phoneInput.value.trim()) {
                        const phoneRegex = /^[\d\s\-\+\(\)]{7,20}$/;
                        if (!phoneRegex.test(phoneInput.value.trim())) {
                            isValid = false;
                            phoneInput.style.borderColor = '#ff4444';
                            if (!firstInvalidField) firstInvalidField = phoneInput;
                        }
                    }
                    
                    if (!isValid) {
                        e.preventDefault();
                        alert('Пожалуйста, проверьте заполнение всех полей. Убедитесь, что email и телефон введены правильно.');
                        if (firstInvalidField) {
                            firstInvalidField.scrollIntoView({
                                behavior: 'smooth',
                                block: 'center'
                            });
                            firstInvalidField.focus();
                        }
                        return false;
                    }
                    
                    // Если все проверки пройдены - показываем красивое сообщение
                    e.preventDefault(); // Останавливаем стандартную отправку
                    
                    // Собираем детали для отображения
                    const service = document.querySelector('.service-option input[type="radio"]:checked').value;
                    const date = new Date(dateInput.value).toLocaleDateString('ru-RU', {
                        weekday: 'long',
                        day: 'numeric',
                        month: 'long',
                        year: 'numeric'
                    });
                    const time = timeSelect.value;
                    const name = nameInput.value;
                    
                    // Отображаем детали в сообщении
                    let detailsHTML = `
                        <p><strong>Услуга:</strong> ${service}</p>
                        <p><strong>Дата:</strong> ${date}</p>
                        <p><strong>Время:</strong> ${time}</p>
                        <p><strong>Имя:</strong> ${name}</p>
                    `;
                    
                    successDetails.innerHTML = detailsHTML;
                    
                    // Показываем красивое сообщение
                    bookingForm.style.display = 'none';
                    successMessage.classList.add('show');
                    successMessage.scrollIntoView({
                        behavior: 'smooth',
                        block: 'center'
                    });
                    
                    // Запускаем отсчет и перенаправление
                    let countdown = 5;
                    const countdownElement = document.getElementById('countdown');
                    
                    const countdownInterval = setInterval(() => {
                        countdown--;
                        countdownElement.textContent = countdown;
                        
                        if (countdown <= 0) {
                            clearInterval(countdownInterval);
                            // Отправляем форму через GET на thank-you.html
                            bookingForm.submit();
                        }
                    }, 1000);
                    
                    // Можно отменить перенаправление
                    const cancelRedirect = document.createElement('button');
                    cancelRedirect.className = 'btn-secondary';
                    cancelRedirect.style.marginTop = '1rem';
                    cancelRedirect.textContent = 'Отмена перенаправления';
                    cancelRedirect.onclick = function() {
                        clearInterval(countdownInterval);
                        this.style.display = 'none';
                        countdownElement.textContent = 'отменено';
                        
                        // Показываем кнопку для ручного перехода
                        const manualRedirect = document.createElement('a');
                        manualRedirect.href = '#';
                        manualRedirect.className = 'btn-primary';
                        manualRedirect.style.marginTop = '1rem';
                        manualRedirect.textContent = 'Перейти на страницу подтверждения';
                        manualRedirect.onclick = function(e) {
                            e.preventDefault();
                            bookingForm.submit();
                        };
                        
                        successMessage.querySelector('.checkmark').parentNode.appendChild(manualRedirect);
                    };
                    
                    successMessage.querySelector('.checkmark').parentNode.appendChild(cancelRedirect);
                    
                    return false;
                });
            }
            
            // 4. Автовыбор услуги из URL параметра
            function autoSelectServiceFromURL() {
                const urlParams = new URLSearchParams(window.location.search);
                const serviceFromURL = urlParams.get('service');
                
                if (serviceFromURL) {
                    const decodedService = decodeURIComponent(serviceFromURL);
                    serviceOptions.forEach(radio => {
                        if (radio.value === decodedService) {
                            radio.checked = true;
                            const event = new Event('change');
                            radio.dispatchEvent(event);
                        }
                    });
                }
            }
            
            autoSelectServiceFromURL();
            
            // 5. Если услуга уже выбрана (при возврате назад)
            const selectedService = document.querySelector('.service-option input[type="radio"]:checked');
            if (selectedService && dateTimeSection) {
                dateTimeSection.classList.add('show');
                setTimeout(checkDateTime, 100);
            }
        });
    </script>
</body>
</html>
